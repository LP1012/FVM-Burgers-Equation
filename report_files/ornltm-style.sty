%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% File: ornltm-style.sty
% Author: Seth R Johnson with contributions by Sam Crawford and John Batson
% Date: Monday April 29 13:41:46 2024
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{ornltm-style}[2018/10/13 package ORNL Technical Memorandum style]

\ProcessOptions\relax

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ALIGNMENT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Aligns entire document ragged right to comply with ORNL's specs.
\RequirePackage[document]{ragged2e}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% GEOMETRY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{geometry}
\geometry{margin=1in,footskip=.75in}
\addtolength{\headheight}{1.6pt}
\addtolength{\topmargin}{-1.6pt}
% \overfullrule=2pt

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FONTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ams math must be loaded before txfonts
\RequirePackage{amsmath}

% Use Times for math font and text font.
\RequirePackage[T1]{fontenc}
\RequirePackage{txfonts}

% Bold math must be loaded after Times font
\RequirePackage{bm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% COLORS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{color} % colored fonts and boxes

% Add pretty link colors if hyperref is loaded
\@ifpackageloaded{hyperref}{\hypersetup{
	colorlinks,
  linkcolor=[rgb]{0.01,0.05,0.1},
	citecolor=[rgb]{0.780,0.647,0.258},
	urlcolor=[rgb]{0.325,0.494,0.658}
}}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LINE SPACING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Do not indent paragraphs
% Note: do NOT use the parskip package: it breaks tocloft; the parfill option
% also breaks \hfill!

\setlength\parskip{0.5\baselineskip \@plus 0.25\baselineskip \@minus 0.25\baselineskip}
\setlength\parindent\z@
\setlength\partopsep\z@

% Update spacing in lists.
\def\@listI{\leftmargin\leftmargini
   \topsep\z@ \parsep\parskip \itemsep\z@}
\let\@listi\@listI
\@listi
     
\def\@listii{\leftmargin\leftmarginii
   \labelwidth\leftmarginii\advance\labelwidth-\labelsep
   \topsep\z@ \parsep\parskip \itemsep\z@}
     
\def\@listiii{\leftmargin\leftmarginiii
    \labelwidth\leftmarginiii\advance\labelwidth-\labelsep
    \topsep\z@ \parsep\parskip \itemsep\z@}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TABLE OF CONTENTS STYLING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{tocloft} % table of contents styling
      
\setcounter{tocdepth}{2} % subsections

% Make the contents, figure, and table titles uppercase and centered
\renewcommand\cfttoctitlefont{\noindent\hspace*{\fill}\bfseries\MakeUppercase}
\renewcommand\cftloftitlefont{\noindent\hspace*{\fill}\bfseries\MakeUppercase}
\renewcommand\cftlottitlefont{\noindent\hspace*{\fill}\bfseries\MakeUppercase}
\renewcommand\cftaftertoctitle{\hspace*{\fill}}
\renewcommand\cftafterloftitle{\hspace*{\fill}}
\renewcommand\cftafterlottitle{\hspace*{\fill}}
% Use plain font style and regular size
\renewcommand\cftsecfont{}
% Add a dot after section numbers
\renewcommand\cftsecaftersnum{.}
% Squish section lines together
\setlength\cftbeforesecskip{0pt}
% Add leaders to all sections and subsections in the TOC.
\renewcommand\cftsecleader{\cftdotfill{\cftdotsep}}
% Make TOC page numbers not bold
\addtocontents{toc}{\protect\renewcommand{\protect\cftsecpagefont}{\mdseries}}

% Add "Figure" # prefix to list of figures
\renewcommand{\cftfigpresnum}{Figure } % put Figure before the number
\renewcommand{\cftfigaftersnum}{.}     % add period after the number
\addtolength{\cftfignumwidth}{1.25cm}     % extra space for extended numbers

% Add "Table" # prefix to list of tables

\renewcommand{\cfttabpresnum}{Table } % put Figure before the number
\renewcommand{\cfttabaftersnum}{.}     % add period after the number
\addtolength{\cfttabnumwidth}{1.25cm}     % extra space for extended numbers


%%% EXTENSIONS FOR SPHINX MANUAL %%%

\if@cfthaspart
\setlength\cftbeforepartskip{.25\baselineskip}
\fi

\if@cfthaschapter
\setlength\cftbeforechapskip{.5\baselineskip}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ABBREVIATION STYLING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\@ifpackageloaded{acro}{\acsetup{%
list/heading = section*, % Set list heading to section but do not number
list/name = {LIST OF ABBREVIATIONS}, % Ensure heading will print correct title
list/template = tabular, % Set list style as tabular for better spacing
list/preamble = { % Adding options to the preamble of the actual list. Any text or TeX can go here (almost).
	\phantomsection % Adding a phantom section so the ToC link will actually go there
	\addcontentsline{toc}{section}{LIST OF ABBREVIATIONS} % Adding line to ToC for the abbreviations
}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TITLE STYLES 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\RequirePackage{titlesec} % title modification: use text size
      
% Show five levels of depth in title labels
\setcounter{secnumdepth}{5} 
            
% Sections go at the top of right-hand-side page.
\titleclass{\section}{top}
\newcommand{\sectionbreak}{\cleardoublepage}
\renewcommand\headrulewidth{0pt}
% You may need to use the \texorpdfstring when using hyperref and
% unusual titles.
\titleformat{\section}{\centering\bf}{\thesection.}{1ex}{\MakeUppercase}[]
\titleformat{\subsection}{\bf}{\thesubsection}{1ex}{\MakeUppercase}[]
\titleformat{\subsubsection}{\bf}{\thesubsubsection}{1ex}{}[]
\titleformat{\paragraph}{\bf}{\theparagraph}{1ex}{}[]
\titleformat{\subparagraph}{\bf\itshape}{\relax}{0pt}{}[]

% Update spacing to account for our custom parskip.
\titlespacing{\section}{\z@}{\parskip}{\z@}
\titlespacing{\subsection}{\z@}{\parskip}{\z@}
\titlespacing{\subsubsection}{\z@}{0.5\parskip}{\z@}
\titlespacing{\paragraph}{\z@}{0.5\parskip}{\z@}
\titlespacing{\subparagraph}{\z@}{0.5\parskip}{\z@}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% APPENDIX PAGE NUMBERING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define a ``section'' command for the appendix
\newcommand\@appendixsection[1]{%
  \cleardoublepage
  % Call the ``section'' command, which will put the title on its own page
  \thispagestyle{empty}
  \renewcommand\headrulewidth{0pt}
  \@oldappendixsection{#1}
  % Increment page counter only if one-sided document (not sure why this is
  % needed)
  \if@twoside\else%
    \stepcounter{page}%
  \fi
  % Add a blank page after the title
  \cleardoublepage
  % Insert the appendix name at the top, with no number, and centered
  \centerline{\bf\appendixname~\thesection.\hspace{.5em}\MakeUppercase{#1}}%
}

\renewcommand\appendixname{APPENDIX}

% Change format for appendices: 'appendix' in title, title takes entire page,
% is not numbered, followed by a blank unnumbered page.
\renewcommand\appendix{%
  \cleardoublepage
  % Reset page style
  \pagenumbering{arabic}%
  \renewcommand\thepage{\thesection-\arabic{page}}%
  % Reset section numbering
  \gdef\thesection{\@Alph\c@section}%
  % Reset section formatting
  \setcounter{section}{0}%
  % Change equation numbering
  \gdef\theequation{\@Alph\c@section.\arabic{equation}}%
  % Reset page and equation numbers at the beginning of every section
  \@addtoreset{equation}{section}%
  \@addtoreset{page}{section}%
  % Change the title format so that the ``header'' is a standalone title page.
  % This allows section and page numbering to be correct, and we can use the
  % macros it defines to insert a ``regular'' appendix label afterward.
	\titleformat{\section}[block]{\null\vfill\bf\filcenter}%
    {\appendixname~\thesection.}{0.5em}{\bf\large\MakeUppercase}[\vfill\null]
  % Save the command we just defined; we'll use it in a command we defined above
  % outside the ``appendix'' macro.
  \let\@oldappendixsection\section
  \let\section\@appendixsection
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\endinput

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% end of ornltm/ornltm/ornltm-style.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
