%! Author = lmi
%! Date = 7/29/2024
\documentclass[11pt, letterpaper]{article}
\usepackage{mathtools}
\usepackage{multicol}
\usepackage[margin=1 in]{geometry}
\usepackage{microtype}
\usepackage[compact,small]{titlesec}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{setspace}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{subcaption}
\usepackage{fancyhdr}
\usepackage{pdfpages}
\usepackage{graphicx}
\usepackage{float}
\usepackage{csvsimple}
\usepackage{booktabs}
\usepackage{adjustbox}
\usepackage{authblk} % Best check on this one...
\usepackage{url}
\usepackage{wrapfig}
\usepackage{physics}
\usepackage[tight]{units}
\captionsetup{font=bf}
\usepackage[T1]{fontenc}
\usepackage{tgpagella}
\usepackage{sectsty}
\usepackage[noabbrev, capitalize]{cleveref}
\usepackage{lipsum}
\usepackage{esint}

\numberwithin{equation}{section}

\sectionfont{\centering}

% ---------------------------------------------------------------------------- %
% Hyperlink setup

\definecolor{ornl_green}{HTML}{007833}
\hypersetup{
	colorlinks=true,
	linkcolor=ornl_green,
	filecolor=magenta,
	urlcolor=ornl_green,
	citecolor=ornl_green
}

\newcommand*{\tensor}[1]{\overline{\overline{\mathbf{#1}}}}

% ---------------------------------------------------------------------------- %
% Treatment of floats
\renewcommand{\topfraction}{0.85}       % max fraction of floats at top
\renewcommand{\textfraction}{0.1}       % allow minimal text w. figs
\renewcommand{\floatpagefraction}{0.7}  % require fuller float pages
\floatplacement{figure}{H}

% ---------------------------------------------------------------------------- %
%\renewcommand{\headrulewidth}{0pt}
%\pagestyle{fancy}
%\fancyhf{}
%\setlength{\headheight}{20pt} % might need to make this 20pt...

\pagestyle{fancy}
\fancyhead[L]{\scshape Liam Pohlmann}
\fancyhead[C]{\scshape Burgers' Equation}
\fancyhead[R]{\scshape Updated: \today}
\addtolength{\topmargin}{-2.5pt}

\renewcommand\Authfont{\fontsize{12}{14.4}\selectfont}
\renewcommand\Affilfont{\fontsize{10}{10.8}\itshape}
%\renewcommand\date{\fontsize{10}{11}}

\onehalfspacing

\title{\normalfont\vspace{-2cm}\textbf{Solution of Burgers' Equation using the Finite Volume Method and Runge-Kutta 4 Time-Stepping under Various Boundary Conditions}}
\author[1,2]{Liam Pohlmann}
\affil[1]{Oak Ridge National Laboratory, Thermal Hydraulics Group}
\affil[2]{University of New Mexico, Department of Nuclear Engineering}


\date{\today}

% Document
\begin{document}
	\maketitle
	\vspace{-0.3cm}

	\tableofcontents

	\clearpage
	\section*{Acknowledgement}
	\begin{center}
		\textit{This research was supported in part by an appointment to the Oak Ridge National Laboratory Research Student Internships Program, sponsored by the U.S. Department of Energy and administered by the Oak Ridge Institute for Science and Education.
		The author would also like to thank Drs. Vineet Kumar, Vivek Rao, and Arpan Sircar for their support of this project through its lifetime.
		}
	\end{center}
	\clearpage
	\begin{center}
	\sffamily\small
	\fbox{\parbox{5.61in}{%
		\begin{center}
			\textbf{DOCUMENT AVAILABILITY}
		\end{center}

		\textbf{\textit{Online Access:}} US Department of Energy (DOE) reports produced after 1991 and a growing number of pre-1991 documents are available free via \href{https://www.osti.gov/}{https://www.osti.gov/}.  \\

		The public may also search the National Technical Information Service's \href{https://ntrl.ntis.gov/NTRL/}{National Technical Reports Library (NTRL)} for reports not available in digital format. \\

		DOE and DOE contractors should contact DOE's Office of Scientific and Technical Information (OSTI) for reports not currently available in digital format: \\

		\begin{quote}
			US Department of Energy \\
			Office of Scientific and Technical Information \\
			PO Box 62 \\
			Oak Ridge, TN 37831-0062 \\
			\textbf{\textit{Telephone:}} (865) 576-8401 \\
			\textbf{\textit{Fax:}} (865) 576-5728 \\
			\textbf{\textit{Email:}}  \href{mailto:reports@osti.gov}{reports@osti.gov} \\
			\textbf{\textit{Website:}} \href{https://www.osti.gov/}{https://www.osti.gov/} \\
		\end{quote}
	}}


	\vspace{\stretch{.5}}
	Prepared by \\
	OAK RIDGE NATIONAL LABORATORY \\
	Oak Ridge, TN 37831 \\
	managed by \\
	UT-BATTELLE LLC \\
	for the \\
	US DEPARTMENT OF ENERGY \\
	under contract DE-AC05-00OR22725
	\end{center}

	\clearpage
	\normalfont

	\section*{Overview}\label{sec:overview}
	The purpose of this document is to outline the steps used to solve Burgers' Equation using the Finite Volume Method (FVM).
	Many texts exist on the FVM and its applications, though few truly walk the student through clear steps to achieve the desired setup.
	This paper aims to bridge the gap between textbooks and practice by detailing the steps to solve a difficult partial differential equation (PDE).
	Code may also be found in the form of a \texttt{git} repository titled \texttt{FVM-Burgers-Equation}.

	Particular instructions will be given to solve for inhomogeneous Dirichlet boundary conditions, inhomogeneous Neumann boundary conditions, and periodic boundary conditions.
	This article is a set of student-made procedures, and thus should be used as a reference of steps taken for a numerical solution, \textit{not} as a document for rigorous mathematical solutions.

	\section*{Note to Students}
	This document was created as part of a personal project of an intern at Oak Ridge National Laboratory in Oak Ridge, Tennessee, United States of America during the summer of 2024.
	The code and systems outlined have undergone many iterations through trial and error over the course of about two weeks.
	True understanding of numerical methods and their strengths and limitations requires years of dedication to reading, listening, and experiencing the field.
	While this paper is not intended to take the place of courses in numerical methods, the author hopes that it may serve as a guide in any project involving numerical methods, particularly those for PDEs.


	\section{Problem Statement} \label{sec:problem-statement}
	Burgers' Equations is a 1-D partial differential equation (PDE) developed as a model to understand fluid flow.
	In particular, it allows for exploration of shocks and rarefactions in fluids, which are discontinuous solutions.
	It is given as~\cite{salihBurgersEquation2016}:
	\begin{equation}
		\label{eq:burgers-equation}
		\pdv{u}{t} + u\pdv{u}{x} = \nu \pdv[2]{u}{x}
	\end{equation}
	or, using different notation:
	\begin{equation}
		\label{eq:alternate-burgers-equation}
		u_t + uu_x=\nu u_{xx}
	\end{equation}
	We can physically interpret \cref{eq:burgers-equation}'s terms as:
	\begin{equation*}
		\begin{split}
			\pdv{u}{t}&=\text{Time-dependent term}\\
			u\pdv{u}{x}&=\text{Advection term}\\
			\nu \pdv[2]{u}{x}&=\text{Diffusion term}
		\end{split}
	\end{equation*}
	For this paper, we choose the initial conditions to be a piecewise-defined step function:
	\begin{equation}
		\label{eq:initial-condition}
		u(x,0)=\begin{cases}
				   u_L, & x<L/2\\
				   u_R, & x\geq L/2
		\end{cases}
	\end{equation}
	in the domain $x\in [0,L]$, $t\in[0,T]$.
	To close the system, the following three boundary conditions will be considered:
	\begin{enumerate}
		\item Inhomogeneous Dirichlet
		\item Inhomogeneous Neumann
		\item Periodic
	\end{enumerate}
	These will be discussed in further detail in \cref{subsec:dirichlet,subsec:neumann,subsec:periodic}.


	\section{Finite Volume Method}\label{sec:finite-volume-method}
	\input{finite-volume-method}


	\section{Numerical Flux Selection} \label{sec:numerical-flux-selection}
	The numerical fluxes given in \cref{eq:burgers-eq-central-diff} are not able to be numerically solved in their current form.
	We must write them in terms of volume centers (i.e. in terms of integer values of $i$, not $i\pm 1/2$).
	To do this, we look to the wisdom passed along to us by mathematicians.

	It is of great importance to select a flux scheme that not only captures the data accurately, but also prevents the nonlinear terms from blowing up completely.
	Some flux schemes that may be of interest:
	\begin{enumerate}
		\item Upwind
		\item Lax-Friedrichs
		\item Lax-Wendroff
		\item Godunov
	\end{enumerate}
	Analyses and explanations of the above schemes would require a significant divergence from the goal of this paper, so the reader is referred to resources such as~\cite{alma992854184708136} for more information.

	Because of its 2\textsuperscript{nd}-order accuracy and reduced dissipative properties, the Lax-Wendroff flux scheme was selected.
	As mentioned by~\cite{LaxWendroffMethodEncyclopedia}, the Lax-Wendroff method is not unique for a nonlinear PDE like it is for a linear PDE.
	One particular method was given by Richtmyer, and in it, the flux is evaluated in two steps.
	This is given as:
	\begin{subequations}
		\begin{equation}
			\label{eq:richtmyer-1st-step}
			u_{i+1/2}^{k+1/2}=\frac{1}{2}\left( u_i^k+u_{i+1}^k \right)+\frac{1}{2}\frac{\Delta t}{\Delta x}\left( f_i^k-f_{i+1}^k \right)
		\end{equation}
		\begin{equation}
			\label{eq:richtmyer-2nd-step}
			f_{i+1/2}=f\left( u_{i+1/2}^{k+1/2} \right)
		\end{equation}
	\end{subequations}
	With the fluxes now able to be evaluated, all that is left is to discretize the time derivative and assemble the volumes into a system of equations.


	\section{Time Discretization} \label{sec:time-discretization}
	There are many methods derived by mathematicians that could be implemented to approximate our time derivative.
	An obvious case might be to approximate with forward differencing (also known as the Forward Euler method), though this method suffers greatly from instability and only first-order accuracy.
	Another option is backward differencing (also known as the Backward Euler method) which solves the issue of stability because of its implicit nature, though it also suffers from first-order accuracy.
	This stability, however, is at the cost of inverting a system.
	Due to the nonlinear nature of \cref{eq:burgers-equation}, solving each time step would require root-finding algorithms such as Newton-Raphson, which adds a significant layer of computational complexity.

	To handle time-stepping, we instead look to the tried-and-true Runge-Kutta methods.
	These methods look to handle time stepping in a forward Euler-like method, where one instead approximates the derivative with a weighted sum.
	These take the form of:
	\begin{equation}
		\label{eq:general-rk-method}
		u^{k+1}=u^k+m^* \times (\Delta t).
	\end{equation}
	Where $\Delta t$ is the size of a single time step.
	In particular, the Runge-Kutta 4 (RK4) method is implemented.
	For some differential equation $\dv{u}{t}=g(u(t),t)$, given $u(t_k)=u^k$ and $t_k=t_0+k\times(\Delta t)$ for $k\in[0,n]$ time steps~\cite{FourthOrderRungeKutta}:
	\begin{equation}
		\label{eq:rk4}
		\begin{split}
			k_1&=g\left( u^k,t_k \right)\\
			k_2&=g\left( u^k+k_1\frac{\Delta t}{2},t_k+\frac{\Delta t}{2} \right)\\
			k_3&=g\left( u^k+k_2\frac{\Delta t}{2},t_k+\frac{\Delta t}{2} \right)\\
			k_4 &= g\left( u^k+k_3 \Delta t,t_k+\Delta t \right)\\ \\
			u^{k+1}&=u^k+\frac{k_1+2k_2+2k_3+k_4}{6}\times(\Delta t)
		\end{split}
	\end{equation}
	In this case, $m^* = \frac{k_1+2k_2+2k_3+k_4}{6}$.
	The RK4 method is $\order{(\Delta t)^4}$ globally~\cite{FourthOrderRungeKutta}, meaning we are much more likely to be restricted in accuracy by our spatial discretization rather than temporal.
	Note that in applying \cref{eq:rk4} to \cref{eq:burgers-equation}, the values $u^{k+1}$,$u^k$,and $k_{1,2,3,4}$ are all \textit{vectors}.
	These vectors contain the function values at each point in space at a particular time and will be denoted with bold font going forward.

	To implement \cref{eq:rk4}, we simply let $g(u^k,t_k)$ equal \cref{eq:burgers-eq-central-diff}, solve for the flux terms, $\mathbf{k_1},\mathbf{k_2},\mathbf{k_3},\mathbf{k_4}$, calculate $\mathbf{m^*}$, and finally take a timestep.


	\section{Boundary Conditions and Implementation}\label{sec:boundary-conditions-and-implementation}
	\input{boundary-conditions-and-implementation}


	\section{Results}\label{sec:results}
	\input{results}


	\section{Conclusion and Next Steps}\label{sec:conclusion}
	For any who have been able to run the included code above $\nu=0.01$, you will notice that the solution rapidly diverges at the interface of the two velocities in the initial condition.
	Though it is not immediately clear what the cause of this instability is, the next steps will likely include explorations of higher-resolution spatial and flux schemes.
	A finer mesh may also greatly improve the quality of the solution, though this will be difficult to achieve without the aid of parallel computing to handle the large matrix-vector products.
	Finally, a conversion from an explicit time-stepping method (RK4) to an implicit method may also improve stability properties.
	As can be shown in the literature~\cite{cameronNOTESBURGERSEQUATION,salihBurgersEquation2016}, the discontinuity present in the solution is a known computational difficulty, and its study will help greatly in understanding more complex equations such as the Navier-Stokes, which also have nonlinearities.

	\appendix


	\section{Splitting a Matrix-Vector Multiply} \label{sec:matrix-vector-multiply}
	Say we have a system $A\mathbf{x}=\mathbf{b}$, and we simply want to evaluate the left-hand-side to verify the result.
	If $A$ is $3\times 3$ where:
	\begin{equation}
		\label{eq:a-matrix}
		A = \begin{bmatrix}
				a & b & c \\
				d & e & f \\
				g & h & i \\
		\end{bmatrix}
	\end{equation}
	and:
	\begin{equation}
		\label{eq:x_vec}
		\mathbf{x} =
		\begin{bmatrix}
			x_1 \\
			x_2 \\
			x_3
		\end{bmatrix},
	\end{equation}
	then their product is:
	\begin{equation}
		\label{eq:ax-product}
		\begin{bmatrix}
			a & b & c \\
			d & e & f \\
			g & h & i \\
		\end{bmatrix}
		\begin{bmatrix}
			x_1 \\
			x_2 \\
			x_3
		\end{bmatrix}=
		\begin{bmatrix}
			ax_1+bx_2+cx_3 \\
			dx_1+ex_2+fx_3 \\
			gx_1+hx_2+ix_3
		\end{bmatrix}
	\end{equation}
	which can also be expressed as:
	\begin{equation}
		\label{eq:matrix-expansion}
		\begin{split}
			\begin{bmatrix}
				ax_1+bx_2+cx_3 \\
				dx_1+ex_2+fx_3 \\
				gx_1+hx_2+ix_3
			\end{bmatrix}
			&=
			\begin{bmatrix}
				ax_1 \\
				bx_1 \\
				cx_1
			\end{bmatrix}+\begin{bmatrix}
							  bx_2+cx_3 \\
							  ex_2+fx_3 \\
							  hx_2+ix_3
			\end{bmatrix}\\
			&=
			\begin{bmatrix}
				a \\
				b \\
				c
			\end{bmatrix}x_1 +
			\begin{bmatrix}
				b & c \\
				e & f \\
				h & i
			\end{bmatrix}\begin{bmatrix}
							 x_2 \\
							 x_3
			\end{bmatrix}
		\end{split}.
	\end{equation}
	The above is particularly useful when a value is known, such as in the case of Dirichlet boundary conditions for a PDE.

	\bibliography{burgers_equation}
	\bibliographystyle{ieeetr}


\end{document}